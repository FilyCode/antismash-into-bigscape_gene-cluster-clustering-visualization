# Anti-Smash Gene Cluster Analysis Workflow

This repository provides a workflow and associated scripts for processing Anti-Smash `.gbk` files, identifying regions of interest, and analyzing them using BiG-SCAPE to create a clustering dendrogram.

## Repository Scripts

This repository includes the following Jupyter Notebooks to facilitate the analysis:

*   `gbk-splitting.ipynb`: Splits Anti-Smash `.gbk` files into individual regions.
*   `find-similar-gbk-files.ipynb`: Filters region files, identifying those with overlap to a query gene cluster.
*   `create-clustering-tree.ipynb`: Generates a dendrogram from BiG-SCAPE's output network file.

## Prerequisites

Before starting the workflow, ensure you have the following:

1.  **Anti-Smash output:** You need `.gbk` files generated from an Anti-Smash run.
2.  **BiG-SCAPE:** Install BiG-SCAPE according to their official documentation.
    *   **BiG-SCAPE GitHub Wiki:** [https://github.com/medema-group/BiG-SCAPE/wiki](https://github.com/medema-group/BiG-SCAPE/wiki)
3.  **Python environment:** A suitable Python environment to run the provided Jupyter Notebooks, including necessary libraries (e.g., `biopython`, `pandas`, `networkx`, `scipy`, `matplotlib`, `seaborn`).

## Workflow Steps

Follow these steps to perform the analysis:

### 1. Obtain Anti-Smash .gbk Files

*   First, run Anti-Smash on your genomic data to generate the `.gbk` files.
*   Download these `.gbk` files into a designated input directory for the subsequent steps.

### 2. Split .gbk Files into Regions

*   Use the `gbk-splitting.ipynb` script to take your Anti-Smash `.gbk` files and split them into individual region files.
*   This script will typically output the split region files into a new directory.

### 3. Filter for Relevant Regions

*   Execute the `find-similar-gbk-files.ipynb` script.
*   This script will filter the previously split region files, keeping only those that contain any overlap with your query gene cluster.
*   Ensure the filtered files are placed in the directory you intend to use as input for BiG-SCAPE (e.g., `antismash/`).

### 4. Run BiG-SCAPE Clustering

*   Activate your BiG-SCAPE conda environment.
*   Navigate to the directory containing your filtered region files (e.g., `antismash/`).
*   Run the BiG-SCAPE clustering command:

    ```bash
    bigscape cluster -i antismash/ -o antismash/ -p Pfam-A.hmm --force-gbk
    ```
    *(Note: Adjust `-i` and `-o` paths if your filtered files are in a different location.)*

### 5. Create Clustering Dendrogram

*   Use the `create-clustering-tree.ipynb` script.
*   This script will take the output network file generated by BiG-SCAPE (usually `bigscape_results/antismash_cluster_networks.tsv` or similar within your output directory) and generate a dendrogram for visualizing the gene cluster relationships.
